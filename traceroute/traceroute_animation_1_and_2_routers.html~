<!DOCTYPE html>
<html>
<head>
<meta charset="utf-8">
<title>traceroute</title>

<!-- local -->
<link rel="stylesheet" href="build/css/freezeframe_styles.css">
<script type="text/javascript" src="src/js/vendor/jquery-2.1.4.js"></script>
<script type="text/javascript" src="src/js/vendor/imagesloaded.pkgd.js"></script>
<script type="text/javascript" src="src/js/freezeframe.js"></script>


<script type="text/javascript">
  $(function() {


    first = new freezeframe('.my_class_first').capture().setup();

    $('.start_first').click(function(e) {
      e.preventDefault();
      first.trigger();
    });

    $('.stop_first').click(function(e) {
      e.preventDefault();
      first.release();
    });

    second = new freezeframe('.my_class_second').capture().setup();

    $('.start_second').click(function(e) {
      e.preventDefault();
      second.trigger();
    });

    $('.stop_second').click(function(e) {
      e.preventDefault();
      second.release();
    });

    third = new freezeframe('.my_class_third').capture().setup();

    $('.start_third').click(function(e) {
      e.preventDefault();
      third.trigger();
    });

    $('.stop_third').click(function(e) {
      e.preventDefault();
      third.release();
    });

    fourth = new freezeframe('.my_class_fourth').capture().setup();

    $('.start_fourth').click(function(e) {
      e.preventDefault();
      fourth.trigger();
    });

    $('.stop_fourth').click(function(e) {
      e.preventDefault();
      fourth.release();
    });

   fifth = new freezeframe('.my_class_fifth').capture().setup();

    $('.start_fifth').click(function(e) {
      e.preventDefault();
      fifth.trigger();
    });

    $('.stop_fifth').click(function(e) {
      e.preventDefault();
      fifth.release();
    });

  sixth = new freezeframe('.my_class_sixth').capture().setup();

    $('.start_sixth').click(function(e) {
      e.preventDefault();
      sixth.trigger();
    });

    $('.stop_sixth').click(function(e) {
      e.preventDefault();
      sixth.release();
    });

  seventh = new freezeframe('.my_class_seventh').capture().setup();

    $('.start_seventh').click(function(e) {
      e.preventDefault();
      seventh.trigger();
    });

    $('.stop_seventh').click(function(e) {
      e.preventDefault();
      seventh.release();
    });
  })
</script>

<style type="text/css">

body {
  text-align: left;
  max-width: 1000px;
  margin: 0px auto;
  padding: 20px;
  color: #202020;
  font-size: 13px;
}

a {
  color: #202020;
}

p {
  font-family: monospace;
  text-align: left;

  padding: 10px 0px;
}

button {
  font-family: monospace;
  text-align: center;

  width: 100px;
  margin: 0px 10px 10px 0px;
  padding: 5px 0px;
  border: 1px solid #000;
  background: #fff;

  outline: none;
}

button:active {
  background: #000;
  color: #fff;
}

.bold {
  font-weight: 700;
}

.italic {
  font-style: italic;
}

div[name=screen]{
    background-color: black;
    color: white;
    padding: 25px;
    border: 10px solid white;
    margin: 25px;
    font-family: "Courier New";
    font-size:20px;
    display: inline-block;
}

</style>

</head>
<body>

The purpose of this presentation is to clarify/correct some of the common misconceptions about traceroute and its related tools.<br>
LastUpdate 2016 05 10  23:12 by Seamus Murray

<div style="width: 960px; color: black; background-color: #d9d9d9; border: 2px solid black; padding: 5px; margin: 20px;">
In This example a packet is routed / passed though the router.
<ol>
<li>The source computer 192.168.0.10 generates and sends a packet with the TTL set to 2 and a destination IP address of 10.10.10.10</li>
<li>The packet arrives at the router with a destination of 10.10.10.10</li>
<li>The router decrements the TTL by 1</li>
<li>The router forwards the packet to the destination computer 10.10.10.10</li>
<li>The destination computer sends the reply to the source computer 192.168.0.10</li>
</ol>


<img class="my_class_first freezeframe-responsive" src="images/1_router_pass_through.gif" >
<button class="start_first">start</button><button class="stop_first">stop</button>1
</div>

<div style="width: 960px; color: black; background-color: #d9d9d9; border: 2px solid black; padding: 5px; margin: 20px;">
In this example the computer on the left is performing a traceroute to the computer on the right (10.10.10.10)..
<ol>
<li>The source computer 192.168.0.10 generates and sends a packet with the TTL set to 2 and a destination IP address of 10.10.10.10</li>
<li>The packet arrives at the router with a destination of 10.10.10.10 </li>
<li>The router decrements the TTL by 1</li>
<li>The packet has now expired on the router</li>
<li>The router generates an ICMP Time-to-Live Exceeded (Type 11), TTL equal 0 during transit (Code 0) message</li> 
<li>The message will have the routers IP address as the source address</li>
<li>The router sends the message back to the original source IP 192.168.0.10<br><br></li>

<li>The source computer generates and sends a packet with the TTL set to 2 and a destination IP address of 10.10.10.10</li>
<li>The 2nd packet arrives at the router 1 with a destination of 10.10.10.10 </li>
<li>Router 1 decrements the TTL by 1</li>
<li>Router 1 forwards the packet to the computer on the right (10.10.10.10)<br><br></li>

<li>The computer on the right (10.10.10.10) sends the reply to the source computer.</li>
</ol>
<img class="my_class_second freezeframe-responsive" src="images/1_router_ideal_situation.gif" >
<button class="start_second">start</button><button class="stop_second">stop</button>2
<div name="screen">
c:\> tracert 10.10.10.10<br>
1 &nbsp 192.168.0.1 &nbsp 10 ms<br>
2 &nbsp 10.10.10.10 &nbsp 20 ms<br>
</div>
</div>


<div style="width: 960px; color: black; background-color: #d9d9d9; border: 2px solid black; padding: 5px; margin: 20px;">
In this example we have 2 routers between the source computer and the destination computer.
<ol>
<li>The source computer generates and sends a packet with the TTL set to 1 and a destination IP address of 10.10.10.10</li>
<li>The 1st packet arrives at the router 1 with a destination of 10.10.10.10</li>
<li>Router 1 decrements the TTL by 1</li>
<li>The 1st packet has now expired on router 1</li>
<li>Router 1 generates an ICMP Time-to-Live Exceeded (Type 11), TTL equal 0 during transit (Code 0)</li> 
<li>The message will have the router 1 IP addess as the source address</li>
<li>Router 1 sends the message back to the original source IP 192.168.0.10<br><br></li>

<li>The source computer generates and sends a packet with the TTL set to 2 and a destination IP address of 10.10.10.10</li>
<li>The 2nd packet arrives at the router 1 with a destination of 10.10.10.10 </li>
<li>Router 1 decrements the TTL by 1</li>
<li>Router 1 forwards the packet to router 2</li>
<li>Router 2 decrements the TTL by 1</li>
<li>The 2nd packet has now expired on router 2</li>
<li>Router 2 generates an ICMP Time-to-Live Exceeded (Type 11), TTL equal 0 during transit (Code 0)</li> 
<li>The message will have the routers 2 IP address as the source address</li>
<li>Router 2 sends the message back to the original source IP<br><br></li>

<li>The source computer generates and sends a packet with the TTL set to 3 and a destination IP address of 10.10.10.10</li>
<li>The 3rd packet arrives at router 1, TTL -1, forwarded to router 2, TTL -1, forwarded to destination computer 10.10.10.10</li>
<li>The destination computer sends the reply to the source computer 192.168.0.10</li>
</ol>
<img class="my_class_third freezeframe-responsive" src="images/2-routers-ideal-stuation.gif" >
<button class="start_third">start</button><button class="stop_third">stop</button>3
<div name="screen">
c:\> tracert 10.10.10.10<br>
1 &nbsp 192.168.0.1 &nbsp 2.0 ms<br>
2 &nbsp 10.10.10.1 &nbsp &nbsp5.0 ms<br>
3 &nbsp 10.10.10.10 &nbsp 7.5 ms<br>
</div>
</div>

<div style="width: 960px; color: black; background-color: #d9d9d9; border: 2px solid black; padding: 5px; margin: 20px;">
In this example there is latency induced by the single router...
<br>
Each packet that is sent though router 1 is delayed.<br>
The traceroute results are similar to the previous example except for the value of the router 1 delay is added to each query.<br>
<img class="my_class_fourth freezeframe-responsive" src="images/1_router_delay_due_to_slow_fastplane.gif" >
<button class="start_fourth">start</button><button class="stop_fourth">stop</button>4a
<div name="screen">
c:\> tracert 10.10.10.10<br>
1 &nbsp 192.168.0.1 &nbsp 15 ms<br>
2 &nbsp 10.10.10.10 &nbsp 30 ms<br>
</div>
</div>






<div style="width: 960px; color: black; background-color: #d9d9d9; border: 2px solid black; padding: 5px; margin: 20px;">
In this example there is latency induced by router 1...
<br>
Each packet that is sent though router 1 is delayed.<br>
The traceroute results are similar to the previous example except for the value of the router 1 delay is added to each query.<br>
<img class="my_class_fourth freezeframe-responsive" src="images/2-routers-latency-induced-by-first-hop.gif" >
<button class="start_fourth">start</button><button class="stop_fourth">stop</button>4b
<div name="screen">
c:\> tracert 10.10.10.10<br>
1 &nbsp 192.168.0.1 &nbsp 5.0 ms<br>
2 &nbsp 10.10.10.1 &nbsp &nbsp6.0 ms<br>
3 &nbsp 10.10.10.10 &nbsp 7.5 ms<br>
</div>
</div>




<div style="width: 960px; color: black; background-color: #d9d9d9; border: 2px solid black; padding: 5px; margin: 20px;">
In this example router drops expired packets but still routes the non exired packets...
<ol>
<li>The source computer generates and sends a packet with the TTL set to 1 and a destination IP address of 10.10.10.10</li>
<li>The 1st packet arrives at the router 1 with a destination of 10.10.10.10</li>
<li>Router 1 decrements the TTL by 1</li>
<li>The 1st packet has now expired on router 1</li>
<li>The control plane of Router 1 is too busy to generate and send an ICMP Time-to-Live Exceeded</li> 
<li>The traceroute client on the source computer times out..</li>
<li>Because there was no packet received with the routers IP as the source address, the source computer can not determine the IP address of router 1, therefore it marks the message as *<br><br></li>

<li>The source computer generates and sends a packet with the TTL set to 2 and a destination IP address of 10.10.10.10</li>
<li>The 2nd packet arrives at the router 1 with a destination of 10.10.10.10 </li>
<li>Router 1 decrements the TTL by 1</li>
<li>Router 1 forwards the packet to computer 10.10.10.10<br><br></li>

<li>The destination computer sends the reply to the source computer 192.168.0.10</li>
</ol>
<img class="my_class_fifth freezeframe-responsive" src="images/1_router_no_tx_exceed_response_due_to_busy_controlplane.gif" >
<button class="start_fifth">start</button><button class="stop_fifth">stop</button>5a
<div name="screen">
c:\> tracert 10.10.10.10<br>
1 &nbsp * <br>
2 &nbsp 10.10.10.10 &nbsp 20 ms
</div><br>
Note: there is no delay in any of the packets passing <strong>through</strong> router 1.
</div>



<div style="width: 960px; color: black; background-color: #d9d9d9; border: 2px solid black; padding: 5px; margin: 20px;">
In this example router 1 drops expired packets...
<ol>
<li>The source computer generates and sends a packet with the TTL set to 1 and a destination IP address of 10.10.10.10</li>
<li>The 1st packet arrives at the router 1 with a destination of 10.10.10.10</li>
<li>Router 1 decrements the TTL by 1</li>
<li>The 1st packet has now expired on router 1</li>
<li>The control plane of Router 1 is too busy to generate and send an ICMP Time-to-Live Exceeded</li> 
<li>The traceroute client on the source computer times out..</li>
<li>Because there was no packet received with the routers IP as the source address, the source computer can not determine the IP address of router 1, therefore it 
marks the message as *<br><br></li>

<li>The source computer generates and sends a packet with the TTL set to 2 and a destination IP address of 10.10.10.10</li>
<li>The 2nd packet arrives at the router 1 with a destination of 10.10.10.10 </li>
<li>Router 1 decrements the TTL by 1</li>
<li>Router 1 forwards the packet to router 2</li>
<li>Router 2 decrements the TTL by 1</li>
<li>The 2nd packet has now expired on router 2</li>
<li>Router 2 generates an ICMP Time-to-Live Exceeded (Type 11), TTL equal 0 during transit (Code 0)</li> 
<li>The message will have the routers 2 IP address as the source address</li>
<li>Router 2 sends the message back to the original source IP<br><br></li>

<li>The source computer generates and sends a packet with the TTL set to 3 and a destination IP address of 10.10.10.10</li>
<li>The 3rd packet arrives at router 1, TTL -1, forwarded to router 2, TTL -1, forwarded to destination computer 10.10.10.10</li>
<li>The destination computer sends the reply to the source computer 192.168.0.10</li>
</ol>
<img class="my_class_fifth freezeframe-responsive" src="images/2-routers-dropped-response.gif" >
<button class="start_fifth">start</button><button class="stop_fifth">stop</button>5b
<div name="screen">
c:\> tracert 10.10.10.10<br>
1 &nbsp * <br>
2 &nbsp 10.10.10.1 &nbsp &nbsp5.0 ms<br>
3 &nbsp 10.10.10.10 &nbsp 7.5 ms<br>
</div><br>
Note: there is no delay in any of the packets passing <strong>through</strong> router 1.
</div>


<div style="width: 960px; color: black; background-color: #d9d9d9; border: 2px solid black; padding: 5px; margin: 20px;">
In this example there is a delay before the router can generate the ICMP Time-to-Live Exceeded message...
<ol>
<li>The source computer generates and sends a packet with the TTL set to 1 and a destination IP address of 10.10.10.10</li>
<li>The 1st packet arrives at the router 1 with a destination of 10.10.10.10</li>
<li>Router 1 decrements the TTL by 1</li>
<li>The 1st packet has now expired on router 1</li>
<li>The control plane of Router 1 is busy and there is a delay while it completes other tasks (updating route tables, compressing log files etc..)</li> 
<li>Router 1 generates an ICMP Time-to-Live Exceeded (Type 11), TTL equal 0 during transit (Code 0)</li> 
<li>The message will have the router 1 IP address as the source address</li>
<li>Router 1 sends the message back to the original source IP<br><br></li>

<li>The source computer generates and sends a packet with the TTL set to 2 and a destination IP address of 10.10.10.10</li>
<li>The 2nd packet arrives at the router 1 with a destination of 10.10.10.10 </li>
<li>Router 1 decrements the TTL by 1</li>
<li>Router 1 forwards the packet to computer 10.10.10.10<br><br></li>

<li>The destination computer sends the reply to the source computer 192.168.0.10</li>
</ol>
<img class="my_class_sixth freezeframe-responsive" src="images/1_router_delay_tx_exceed_response_due_to_busy_controlplane.gif" >
<button class="start_sixth">start</button><button class="stop_sixth">stop</button>6a
<div name="screen">
c:\> tracert 10.10.10.10<br>
1 &nbsp 192.168.0.1 &nbsp 30 ms <br>
2 &nbsp 10.10.10.10 &nbsp 20 ms<br>
</div><br>

Note: there is no delay in any of the packets passing <strong>through</strong> router 1.

</div>

<div style="width: 960px; color: black; background-color: #d9d9d9; border: 2px solid black; padding: 5px; margin: 20px;">
In this example ..2-routers-delay-response.gif
<ol>
<li>The source computer generates and sends a packet with the TTL set to 1 and a destination IP address of 10.10.10.10</li>
<li>The 1st packet arrives at the router 1 with a destination of 10.10.10.10</li>
<li>Router 1 decrements the TTL by 1</li>
<li>The 1st packet has now expired on router 1</li>
<li>The control plane of Router 1 is busy and there is a delay while it completes other tasks (updating route tables, compressing log files etc..)</li> 
<li>Router 1 generates an ICMP Time-to-Live Exceeded (Type 11), TTL equal 0 during transit (Code 0)</li> 
<li>The message will have the router 1 IP address as the source address</li>
<li>Router 1 sends the message back to the original source IP<br><br></li>

<li>The source computer generates and sends a packet with the TTL set to 2 and a destination IP address of 10.10.10.10</li>
<li>The 2nd packet arrives at the router 1 with a destination of 10.10.10.10 </li>
<li>Router 1 decrements the TTL by 1</li>
<li>Router 1 forwards the packet to router 2</li>
<li>Router 2 decrements the TTL by 1</li>
<li>The 2nd packet has now expired on router 2</li>
<li>Router 2 generates an ICMP Time-to-Live Exceeded (Type 11), TTL equal 0 during transit (Code 0)</li> 
<li>The message will have the routers 2 IP address as the source address</li>
<li>Router 2 sends the message back to the original source IP<br><br></li>

<li>The source computer generates and sends a packet with the TTL set to 3 and a destination IP address of 10.10.10.10</li>
<li>The 3rd packet arrives at router 1, TTL -1, forwarded to router 2, TTL -1, forwarded to destination computer 10.10.10.10</li>
<li>The destination computer sends the reply to the source computer 192.168.0.10</li>
</ol>
<img class="my_class_sixth freezeframe-responsive" src="images/2-routers-delay-response.gif" >
<button class="start_sixth">start</button><button class="stop_sixth">stop</button>6b
<div name="screen">
c:\> tracert 10.10.10.10<br>
1 &nbsp 192.168.0.1 &nbsp 7.0 ms <br>
2 &nbsp 10.10.10.1 &nbsp &nbsp5.0 ms<br>
3 &nbsp 10.10.10.10 &nbsp 7.5 ms<br>
</div><br>

Note: there is no delay in any of the packets passing <strong>through</strong> router 1.


</div>
<div style="width: 960px; color: black; background-color: #d9d9d9; border: 2px solid black; padding: 5px; margin: 20px;">

<div style="width: 800px;" > 
<img class="my_class_seventh freezeframe-responsive" src="images/traceroute-arrows.gif" width="800px" >
<button class="start_seventh">start</button><button class="stop_seventh">stop</button>7a
<div style="margin-top: 10px; display: inline-block;" >
<img src="images/key.png" >
</div><br>

</div>

</div>

<a rel="license" href="http://creativecommons.org/licenses/by-sa/4.0/"><img alt="Creative Commons License" style="border-width:0" src="https://i.creativecommons.org/l/by-sa/4.0/88x31.png" /></a><br /><span xmlns:dct="http://purl.org/dc/terms/" property="dct:title">Traceroute Animations</span> by <span xmlns:cc="http://creativecommons.org/ns#" property="cc:attributionName">Seamus Murray</span> is licensed under a <a rel="license" href="http://creativecommons.org/licenses/by-sa/4.0/">Creative Commons Attribution-ShareAlike 4.0 International License</a>.
</body>
</html>
